openapi: 3.0.1
servers:
  - url: 'https://api.eodc.eu/api/v0.5/'
    description: 'The URL to the EODC API'
    variables:
      version:
        default: v0.5
        description: API versioning
info:
  title: EODC API
  version: 0.3.0
  description: 'The EODC API provides access to the EODC services and data, as well as access to the openEO endpoints.'
  contact:
    name: Gunnar Busch
    url: 'https://api.eodc.eu'
    email: gunnar.busch@eodc.eu
  license:
    name: Apache 2.0
    url: 'http://www.apache.org/licenses/LICENSE-2.0.html'
externalDocs:
  description: EODC API Description
  url: 'https://api.eodc.eu/redoc'
tags:
  - name: OpenAPI
    description: The OpenAPI specification and Tools for inspecting
  - name: Capabilities
    description: General information about the API implementation and other supported capabilities at the back-end.
  - name: EO Data Discovery
    description: Discovery of Earth observation datasets that are available at the back-end.
  - name: Process Discovery
    description: Discovery of processes that are available at the back-end.
  - name: Authentication
    description: Authentication of users.
  - name: File Management
    description: Management of user-uploaded assets and processed data.
  - name: Process Graph Management
    description: Management of stored process graphs.
  - name: Job Management
    description: Management of batch processing tasks (jobs) and their results.
  - name: Web Service Management
    description: On-demand access to data using other web services protocols.
paths:
# Included from the OpenEO specification
  /:
    $ref: https://raw.githubusercontent.com/Open-EO/openeo-api/0.3.0/openapi.json#/paths/~1
  /data:
    $ref: https://raw.githubusercontent.com/Open-EO/openeo-api/0.3.0/openapi.json#/paths/~1data
  '/data/{data_id}':
    $ref: https://raw.githubusercontent.com/Open-EO/openeo-api/0.3.0/openapi.json#/paths/~1data~1{data_id}
  /processes:
    get:
      $ref: https://raw.githubusercontent.com/Open-EO/openeo-api/0.3.0/openapi.json#/paths/~1processes/get
    post:
      summary: Creates a new process.
      description: >-
        The request will ask the back-end to create a new process using the desciption send in the request body. 
        \n\n **Note:** This is an extension of the EODC API!
      tags:
        - Process Discovery
      requestBody:
        $ref: https://raw.githubusercontent.com/Open-EO/openeo-api/0.3.0/openapi.json#/paths/~1processes/get/responses/200
      security:
        - {}
        - Bearer: []
      responses:
        '201':
          description: The processes has been successfully created.
        4XX:
          $ref: https://raw.githubusercontent.com/Open-EO/openeo-api/0.3.0/openapi.json#/components/responses/client_error
        5XX:
          $ref: https://raw.githubusercontent.com/Open-EO/openeo-api/0.3.0/openapi.json#/components/responses/server_error


# Extensions for the EODC API
  /openapi:
    get:
      summary: OpenAPI v3.0.1 specification
      description: >-
        The request will return the OpenAPI v3.0.1 specification as JSON document.
        \n\n **Note:** This is an extension of the EODC API!
      tags: 
        - OpenAPI
      responses:
        '200':
          description: The OpenAPI v3.0.1 specification.
        4XX:
          $ref: https://raw.githubusercontent.com/Open-EO/openeo-api/0.3.0/openapi.json#/components/responses/client_error
        5XX:
          $ref: https://raw.githubusercontent.com/Open-EO/openeo-api/0.3.0/openapi.json#/components/responses/server_error
  /redoc:
    get:
      summary: API Reference
      description: >-
        The request will return a ReDoc client that can be used to inspect the OpenAPi v3.0.1 specification.
        \n\n **Note:** This is an extension of the EODC API!
      tags: 
        - OpenAPI
      responses:
        '200':
          description: Returns the ReDoc client to view the OpenAPI v3.0.1 specification.
        4XX:
          $ref: https://raw.githubusercontent.com/Open-EO/openeo-api/0.3.0/openapi.json#/components/responses/client_error
        5XX:
          $ref: https://raw.githubusercontent.com/Open-EO/openeo-api/0.3.0/openapi.json#/components/responses/server_error
  '/data/{data_id}/records':
    parameters:
      - $ref: https://raw.githubusercontent.com/Open-EO/openeo-api/0.3.0/openapi.json#/components/parameters/data_id
      - $ref: "#/components/parameters/detail"
      - $ref: "#/components/parameters/spatial_extent"
      - $ref: "#/components/parameters/temporal_extent"
    get:
      summary: Information the records of a specific EO dataset with the spatial and temporal extents.
      description: >-
        The request will ask the back-end for further details about the records of a dataset specified by the identifier `data_id`. 
        \n\n **Note:** This is an extension of the EODC API!
      tags:
        - EO Data Discovery
      security:
        - {}
        - Bearer: []
      responses:
        '200':
          description: The dataset records that are matching the the spatial and temporal extents.
        4XX:
          $ref: https://raw.githubusercontent.com/Open-EO/openeo-api/0.3.0/openapi.json#/components/responses/client_error
        5XX:
          $ref: https://raw.githubusercontent.com/Open-EO/openeo-api/0.3.0/openapi.json#/components/responses/server_error
components:
  schemas:
    process_graph:
      $ref: https://raw.githubusercontent.com/Open-EO/openeo-api/0.3.0/openapi.json#/components/schemas/process_graph
    variable:
      $ref: https://raw.githubusercontent.com/Open-EO/openeo-api/0.3.0/openapi.json#/components/schemas/variable
    detail:
      type: string
      description: Detail level of the record (full, short, file_paths)
      enum: [
        "full",
        "short",
        "file_path"
      ]
      default: short
      example: short
    spatial_extent:
      type: string
      description: "Spatial extent covered by the data ( Bbox: [-4, -4, 4, 4] or WKT ((-4 -4, -4 4, 4 -4, 4 4, -4 -4)) )."
      pattern: ^(\[(\-?\d{1,3}\,?\s*){4}\]|\(\((\-?\d{1,3}\s\-?\d{1,3}\,?\s*){5}\)\))$
      example: "[-4, -4, 4, 4]"
    temporal_extent:
      type: string
      description: Spatial extent covered by the data
      pattern: ^([12]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01]))\/([12]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01]))$
      example: 2016-01-01/2017-10-31
  parameters:
    detail:
      name: detail
      in: query
      description: Detail level of the record (full, short, file_paths)
      required: false
      schema:
        "$ref": "#/components/schemas/detail"
    spatial_extent:
      name: spatial_extent
      in: query
      description: Spatial extent covered by the data
      required: true
      schema:
        "$ref": "#/components/schemas/spatial_extent"
    temporal_extent:
      name: temporal_extent
      in: query
      description: Temporal extent covered by the data
      required: true
      schema:
        "$ref": "#/components/schemas/temporal_extent"